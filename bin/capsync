#!/usr/bin/env ruby

if ARGV.size < 2
  puts "Improper invocation: capsync from to"
  exit 1
end

from, to = ARGV[0], ARGV[1]
puts "\033[1;41m capsync invoked: Restoring #{from} database backup to #{to} environment \033[0m"

require 'rubygems'
require 'capistrano'
require 'capistrano/cli'
require 'capistrano-extensions/configuration'
require 'capistrano-extensions/db_sync'

from_config = Capistrano::Configuration.new(from)
to_config   = Capistrano::Configuration.new(to)

db_sync     = DbSync.new(from_config, to_config)
db_sync.sync!
